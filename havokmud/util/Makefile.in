##
## The compiler your gonna use to compile this with..
##
CC=@CC@
##
LD=$(CC)
RANLIB=@RANLIB@

ROOT=..

## Include dirs
INCDIRS = -I. -I${ROOT} -I${ROOT}/include -I${ROOT}/util @INCLUDES@

##  these are architecture dependent flags
CFLAGS = -g -O6 -Wall -Werror -Wno-trigraphs -Wno-long-long -std=c99 -pedantic \
	 ${INCDIRS}

##  Libraries
LIBS = @LIBS@ -pthread
LDFLAGS = @LDFLAGS@


SRCS =	linked_list.c queue.c buffer.c protected_data.c balanced_btree.c
SRCS += text_process.c
ARCHIVE =	libhavokutils.a

OBJS = ${SRCS:.c=.o}
DEPS = ${SRCS:.c=.d}

all : $(ARCHIVE)

$(ARCHIVE) : ${OBJS}
	$(AR) rcv $@ $+
	$(RANLIB) $@

depend : ${DEPS}

${DEPS} : Makefile

%.d: %.c
	@echo "Making $@ (dependencies for $<)"
	@${CC} -MM ${CFLAGS} $< | sed 's,\($*\)\.o[ :]*,\1.o $@ : ,g'  > $@

.PHONY: clean cleanall

clean:
	rm -f $(OBJS) $(ARCHIVE)

cleanall: clean
	rm -f ${DEPS}

distclean: cleanall
	rm -f Makefile

Makefile: Makefile.in ${ROOT}/configure
	@echo Your Makefile is out of date, rerun ${ROOT}/configure
	

-include ${DEPS}

